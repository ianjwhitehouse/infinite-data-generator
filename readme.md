# Infinite Data Generator
### Utility for generating a vast majority of plausible, realistic-looking images for computer vision applications using Stable Diffusion  
  
## Goals
Synthetic data is an important and widely used technique for machine learning model training.  This technique is most useful when there is limited data for the task that the machine learning model is attempting to master.  Therefore, for my generative image project, I wanted to attempt to make a synthetic data generator that could be used in object detection or object simulation problems within computer vision.  My project takes a prompt for the background/null class and a prompt for the positive class(es).  Then, it combines the two using a semi-random bounding box and in-painting.  The resulting images can be used as X during model training, while the bounding boxes can be used as y.
  
For this project to be successful, I will create a controllable process that generates realistic-looking images for computer vision machine learning model training.  Therefore, the realism of the generated images and their judged usefulness for machine learning training will be how I judge whether this project is successful.  
  
In total, I generated two datasets, one of forest fires and one of African animals.  The prompts to generate these and the resulting images and segmentation masks are attached.  
## Installation and Use
After downloading/cloning the repository, you can build the environment in Anaconda using `conda env create -f environment.yml`.The project is controlled through the `background.csv` and `classes.csv` files.  
  
## Process
<p align="center">
  <img src="https://github.com/ianjwhitehouse/infinite-data-generator/assets/15909624/b52996f4-1fc1-458a-9757-79c0d9a0dc03" alt="Diagram showing the image generation process" />
</p>
  
The process uses the Stable Diffusion model twice.  First, it generates a set number of background images based on the prompt(s) in `background.png`.  
  
<p align="center">
  <img src="https://github.com/ianjwhitehouse/infinite-data-generator/assets/15909624/c1014603-cdef-4a38-a44b-6302cce90f38" alt="Diagram showing Stable Diffusion generating two background images" />
</p>
  
Then it uses the prompt(s) in `classes.csv` to in-paint the class into set areas of the images.  These areas match the bounding boxes created based on the other parameters within the `classes.csv` file.  
  
<p align="center">
  <img src="https://github.com/ianjwhitehouse/infinite-data-generator/assets/15909624/191b2f78-e6fd-4121-9a59-7371bb948499" alt="Diagram showing Stable Diffusion generating two background images" />
</p>
  
Finally, the resulting images and bounding boxes can be used to train a classification model.  After training on these images, the model can be refined only on real images.  
  
## Results
The results are somewhat a mixed bag, but I think it would be interesting to use this process to generate data that a model is actually trained on.  Some of the processes results are good and it successfully adds the positive class(s) into the image without messing it up.  
  
<p align="center">
  <img src="https://github.com/ianjwhitehouse/infinite-data-generator/assets/15909624/50207a05-7d64-4f07-a261-948d5a5f77f5" alt="Successful(ish) imaged generated by this process" />
</p>  
  
Even in these results though, there are a couple key issues that could make it hard to use the dataset in a machine learning model
 - The borders around where the animal or fire was added is very clear.  The model could learn to use these borders to learn the bounding boxes, not the fire or animal itself
 - In the bottom right corner, the the zebras are both half-generated.  This seems to occur when the model cannot fit the class into the rectangular area that the class is added
 - The images contain artifacts, oddities and other things that could distract the machine learning model during training
  
Despite these flaws, the examples shown are reasonably realistic.  Therefore, I am very interested in seeing how these images would effect a model's training.
